## TCP/IP

- OSI 七层模型

  - 应用层： HTTP、HTTPS、FTP、SMTP、DNS —— HTML、应用程序、协议、数据

  - 表示层：格式转换 —— JPEG、GIF、MP3、MP4 —— 编码、压缩、加密、解密

  - 会话层：建立、管理、终止会话 —— RPC、NFS

  - 传输层：TCP、UDP —— 端口号、流量控制、拥塞控制

  - 网络层：IP、ICMP —— 路由器、网关

  - 数据链路层：物理地址寻址，ARP、RARP —— 交换机、网卡

  - 物理层：物理设备标准 —— RJ45

- 协议是什么？ ——

- TCP/IP 协议是什么 —— 是一个协议家族，以 TCP 和 IP 为核心的四层协议

  - 应用层： HTTP、HTTPS、FTP、SMTP、DNS —— HTML、应用程序、协议、数据
  - 传输层：TCP、UDP —— 端口号、流量控制、拥塞控制
  - 网络层：IP、ICMP —— 路由器、网关

- TCP/IP 四层模型 —— 将 OSI 七层模型中的应用层、表示层、会话层合并到了传输层中，将 OSI 七层模型中的网络层、数据链路层、物理层合并到了网络层中

  - 应用层： HTTP、HTTPS、FTP、SMTP、DNS —— HTML、应用程序、协议、数据
  - 传输层：TCP、UDP —— 端口号、流量控制、拥塞控制
  - 网络层：IP、ICMP —— 路由器、网关
  - 数据链路层：物理地址寻址，ARP、RARP —— 交换机、网卡

- 数据包是什么 —— 数据 + 地址信息

  - 网络层及以上分层中包的单位

  - 对于下层，会在上层数据的

- TCP/UDP 的区别

  - TCP：面向连接的、可靠的、基于字节流的传输层通信协议，必须建立连接，传输前需要三次握手，传输完成需要四次挥手，保证数据的正确性和顺序性，传输效率较低，适用于对数据完整性要求较高的应用场景，如文件传输、电子邮件、视频会议等

  - UDP：无连接的、不可靠的、基于数据报的传输层通信协议，不需要建立连接，传输效率较高，适用于对数据完整性要求不高的应用场景，如实时音视频、DNS 查询等

- TCP 通过什么方式提供可靠性

  - 超时重传：发出的报文如果在一定时间内没有收到确认，就会重新发送

  - 校验和：校验首部数据和，校验数据是否完整

  - 序列号：保证数据顺序，会对失序的数据包进行重排序

  - 确认应答：保证数据到达

  - 流量控制：保证数据不超过接收方的处理能力，防止缓存区溢出

  - 拥塞控制：保证网络不会因为拥塞而导致丢包

  - 快重传和快恢复

- TCP 如何进行拥塞控制

  - 目的：防止过多数据涌入造成路由器或链路过载

  - 原理：发送方维护一个拥塞窗口，拥塞窗口的大小取决于网络的拥塞程度，发送方控制发送的速率，让网络能够承受当前的拥塞程度

  - 算法：

    - 慢启动：发送方一开始发送少量数据，每收到一个确认应答，就将拥塞窗口增加一倍，直到达到慢启动门限

    - 拥塞避免：发送方让拥塞窗口缓慢增加，每经过一个往返时间RTT，就把发送方的拥塞窗口加1，使拥塞窗口的大小按线性规律增长

    - 快重传：接收方收到三个重复的确认，就立即重传对方尚未收到的报文段，而不必等待设置的重传计时器到期

    - 快恢复：接收方收到三个重复的确认，就执行乘法减小算法，把慢启动门限减半，这样可以使发送方在超时重传之前把更多的报文段发送出去，从而减少因超时重传带来的额外延迟


- IP 地址

  - IPv4 —— 32位二进制数

  - IPv6 —— 128位二进制数
  - 子网掩码 —— 32位二进制数，用于确定一个IP地址属于哪个网络
  - 网关 —— 用于将不同网络之间的数据包传输到正确的网络中
  - 路由表 —— 用于确定数据包应该通过哪个网关发送

- DNS 是什么 —— 域名系统 domain name system，将域名解析成IP地址
  - 域名：www.baidu.com
  - IP地址：114.114.114.114
  - 域名服务器：负责将域名解析成IP地址
  - 根域名服务器：负责将顶级域名服务器的地址返回给本地域名服务器

- Node.js 创建 TCP 服务

Socket  

## HTTP

1. HTTP 是建立在 TCP 之上的

2. 一次完整的 HTTP 通信

  1. 建立 TCP 连接 —— 先建立 TCP 连接才能建立 HTTP 连接

  2. 客户端向服务端发送请求命令 —— GET/info HTTP/1.1

  3. 客户端发送请求头信息 request header

  4. 服务器应答 —— 协议版本号 & 响应状态吗 HTTP/1.1 200 OK

  5. 服务端返回响应头信息 response header

  6. 服务端向客户端响应数据 Content-Type

  7. 服务器关闭 TCP 连接 —— Connection： keep-alive

### HTTP 协议有哪些特点

1. 通过响应和请求的交换达成通信

2. 无状态 —— 通过 Cookie 来状态管理

3. 通过 URL 定位资源 —— URI 和 URL 的区别

4. 通过各种方法来标识自己的意图 —— GET POST 

5. 持久连接 —— HTTP/1.1 所有请求默认持久连接 + Connection：close

6. 管道机制 —— 支持在同一个 TCP 连接里可以同时发送多个请求

### HTTP 1.0/1.1/2/0 在并发请求上的区别

1. HTTP/1.0  —— 每个 TCP 连接只能发送一个请求

2. HTTP/1.1  —— 增加管道机制，默认采用持久连接

3. HTTP/2.0  —— 增加双工模式，不仅能够同时发送多个请求，服务器也可同时响应多个请求 ｜ 服务器推送功能，服务器可主动向客户端发送数据

### 请求报文

```
*   Trying 127.0.0.1:80...  —— TCP 的三次握手
* Connected to 127.0.0.1 (127.0.0.1) port 80
> GET / HTTP/1.1
> Host: 127.0.0.1
> User-Agent: curl/8.7.1
> Accept: */*
> （用一行空白表示发送完毕）
* Request completely sent off
< HTTP/1.1 200 OK
< Content-Type: text/plain
< Date: Thu, 05 Dec 2024 12:52:53 GMT
< Connection: keep-alive
< Keep-Alive: timeout=5
< Transfer-Encoding: chunked
< 
* Connection #0 to host 127.0.0.1 left intact
HTTP END%  —— Data
```

## 服务部署

1. 服务器

2. 在服务器 Linux 上安装 Node.js

  1. 下载安装包 —— ‘wget’

  2. 解压 —— ‘tar xf’

3. 设置软链接，把 Node Npm 等链接到全局 —— 'ln -s '

4. 设置 npm 源 —— npm config set registry

5. 服务器安装 pm2 —— npm install pm2 -g

6. 配置 SSH

  1. 本地生成密钥对 ssh-keygen -t rsa

  2. 将公钥上传到服务器 —— scp ~/.ssh/demo_id_rsa_pub root@

7. 将本地代码同步到远成 —— rsync -avzp -e "ssh" ./Internet 

8. 服务器启动 http 服务